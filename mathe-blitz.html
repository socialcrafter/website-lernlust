<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Mathe-Blitz ‚Äì ADHS Training</title>
    <link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:wght@400;700&family=Lexend:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-warm: #faf8f5;
            --bg-card: #ffffff;
            --text-primary: #2d3436;
            --text-muted: #636e72;
            --accent-calm: #74b9ff;
            --accent-success: #00b894;
            --accent-gentle: #a29bfe;
            --accent-warm: #fdcb6e;
            --shadow-soft: 0 8px 32px rgba(45, 52, 54, 0.08);
            --shadow-lift: 0 12px 40px rgba(45, 52, 54, 0.12);
            --radius: 24px;
            --radius-sm: 16px;
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Lexend', sans-serif;
            background: var(--bg-warm);
            background-image: 
                radial-gradient(ellipse at 20% 20%, rgba(116, 185, 255, 0.08) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(162, 155, 254, 0.08) 0%, transparent 50%);
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--text-primary);
        }

        .screen {
            width: 100%;
            max-width: 400px;
            display: none;
            flex-direction: column;
            align-items: center;
            animation: fadeIn 0.4s ease-out;
        }

        .screen.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes cardPop {
            0% { transform: scale(0.95); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        @keyframes gentlePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        @keyframes celebrateShake {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-3deg); }
            75% { transform: rotate(3deg); }
        }

        /* Start Screen */
        .logo {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
            letter-spacing: -0.02em;
        }

        .logo span {
            background: linear-gradient(135deg, var(--accent-calm), var(--accent-gentle));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 1rem;
            color: var(--text-muted);
            margin-bottom: 48px;
            font-weight: 300;
        }

        .mode-grid {
            display: flex;
            flex-direction: column;
            gap: 16px;
            width: 100%;
        }

        .mode-btn {
            background: var(--bg-card);
            border: 2px solid transparent;
            border-radius: var(--radius);
            padding: 24px;
            cursor: pointer;
            transition: all 0.25s ease;
            box-shadow: var(--shadow-soft);
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .mode-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lift);
        }

        .mode-btn:active {
            transform: scale(0.98);
        }

        .mode-icon {
            width: 56px;
            height: 56px;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .mode-btn.plus .mode-icon {
            background: linear-gradient(135deg, #81ecec, #00b894);
        }

        .mode-btn.mult .mode-icon {
            background: linear-gradient(135deg, #a29bfe, #6c5ce7);
        }

        .mode-btn.pyramid .mode-icon {
            background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
        }

        .mode-btn.zehner .mode-icon {
            background: linear-gradient(135deg, #f0932b, #e67e22);
        }

        .mode-info {
            text-align: left;
        }

        .mode-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .mode-desc {
            font-size: 0.85rem;
            color: var(--text-muted);
            font-weight: 300;
        }

        /* Training Screen */
        .hint-text {
            font-family: 'Atkinson Hyperlegible', sans-serif;
            font-size: 1.1rem;
            color: var(--text-muted);
            margin-bottom: 24px;
            text-align: center;
            min-height: 28px;
            transition: all 0.3s ease;
        }

        .hint-text.emphasis {
            color: var(--accent-success);
            font-weight: 700;
        }

        .card {
            background: var(--bg-card);
            width: 100%;
            aspect-ratio: 4/3;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lift);
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Atkinson Hyperlegible', sans-serif;
            font-size: 4rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 32px;
            position: relative;
            overflow: hidden;
            animation: cardPop 0.3s ease-out;
            transition: background 0.3s ease, font-size 0.3s ease;
        }

        .card.revealed {
            background: linear-gradient(135deg, #e8f8f5, #d5f4e6);
        }

        .card.celebrate {
            animation: celebrateShake 0.5s ease;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, var(--accent-calm), var(--accent-gentle));
            opacity: 0.6;
        }

        .progress-dots {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
        }

        .dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #dfe6e9;
            transition: all 0.3s ease;
        }

        .dot.done {
            background: var(--accent-success);
        }

        .dot.current {
            background: var(--accent-calm);
            animation: gentlePulse 1.5s ease-in-out infinite;
        }

        .controls {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .btn {
            font-family: 'Lexend', sans-serif;
            font-size: 1.1rem;
            font-weight: 500;
            padding: 20px 24px;
            border: none;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn:active {
            transform: scale(0.97);
        }

        .btn-reveal {
            background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
            color: #6c5ce7;
            box-shadow: 0 4px 16px rgba(253, 203, 110, 0.4);
        }

        .btn-reveal:hover {
            box-shadow: 0 6px 20px rgba(253, 203, 110, 0.5);
        }

        .btn-row {
            display: flex;
            gap: 12px;
        }

        .btn-yes {
            flex: 1;
            background: linear-gradient(135deg, #55efc4, #00b894);
            color: white;
            box-shadow: 0 4px 16px rgba(0, 184, 148, 0.3);
        }

        .btn-no {
            flex: 1;
            background: linear-gradient(135deg, #fd79a8, #e84393);
            color: white;
            box-shadow: 0 4px 16px rgba(232, 67, 147, 0.3);
        }

        .btn-back {
            background: transparent;
            color: var(--text-muted);
            font-size: 0.9rem;
            padding: 12px;
            margin-top: 16px;
        }

        .btn-back:hover {
            color: var(--text-primary);
        }

        .hidden {
            display: none !important;
        }

        /* Finish Screen */
        .finish-icon {
            font-size: 5rem;
            margin-bottom: 16px;
            animation: celebrateShake 0.6s ease infinite;
        }

        .finish-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .finish-subtitle {
            color: var(--text-muted);
            margin-bottom: 32px;
        }

        .stats {
            background: var(--bg-card);
            border-radius: var(--radius);
            padding: 24px;
            width: 100%;
            box-shadow: var(--shadow-soft);
            margin-bottom: 24px;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .stat-row:last-child {
            border-bottom: none;
        }

        .stat-label {
            color: var(--text-muted);
        }

        .stat-value {
            font-weight: 700;
            color: var(--accent-success);
        }

        .btn-restart {
            background: linear-gradient(135deg, var(--accent-calm), var(--accent-gentle));
            color: white;
            width: 100%;
            box-shadow: 0 4px 16px rgba(116, 185, 255, 0.4);
        }

        /* Pyramid Mode Specifics */
        .pyramid-level {
            font-size: 0.9rem;
            color: var(--accent-gentle);
            font-weight: 500;
            margin-bottom: 8px;
        }

        /* Responsive */
        @media (max-width: 420px) {
            body {
                padding: 16px;
            }
            .card {
                font-size: 3rem;
            }
            .logo {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>

    <!-- Start Screen -->
    <div id="start-screen" class="screen active">
        <div class="logo">Mathe-<span>Blitz</span> ‚ö°</div>
        <div class="subtitle">Entspannt lernen ‚Äì nicht rechnen!</div>
        
        <div class="mode-grid">
            <button class="mode-btn plus" onclick="startTraining('plus10')">
                <div class="mode-icon">‚ûï</div>
                <div class="mode-info">
                    <div class="mode-title">Addition bis 10</div>
                    <div class="mode-desc">Grundlagen sicher machen</div>
                </div>
            </button>

            <button class="mode-btn zehner" onclick="startTraining('zehner')">
                <div class="mode-icon">üåâ</div>
                <div class="mode-info">
                    <div class="mode-title">Zehner√ºbergang</div>
                    <div class="mode-desc">Plus-Rechnen √ºber 10</div>
                </div>
            </button>
            
            <button class="mode-btn mult" onclick="startTraining('mult')">
                <div class="mode-icon">‚úñÔ∏è</div>
                <div class="mode-info">
                    <div class="mode-title">Kleines 1√ó1</div>
                    <div class="mode-desc">Malreihen automatisieren</div>
                </div>
            </button>
            
            <button class="mode-btn pyramid" onclick="startTraining('pyramid')">
                <div class="mode-icon">üî∫</div>
                <div class="mode-info">
                    <div class="mode-title">Pyramiden-Spiel</div>
                    <div class="mode-desc">Level f√ºr Level ‚Äì mit Belohnung!</div>
                </div>
            </button>
        </div>
    </div>

    <!-- Training Screen -->
    <div id="training-screen" class="screen">
        <div class="pyramid-level hidden" id="pyramid-level"></div>
        <div class="hint-text" id="hint-text">Weisst du es sofort?</div>
        
        <div class="progress-dots" id="progress-dots"></div>
        
        <div class="card" id="math-card"></div>
        
        <div class="controls" id="pre-reveal">
            <button class="btn btn-reveal" onclick="revealAnswer()">
                <span>üëÄ</span> L√∂sung zeigen
            </button>
            <div style="text-align: center; color: var(--text-muted); font-size: 0.85rem; margin-top: 4px;">
                Nicht anstrengen ‚Äì einfach anschauen!
            </div>
        </div>
        
        <div class="controls hidden" id="post-reveal">
            <div style="text-align: center; color: var(--text-muted); font-size: 0.9rem; margin-bottom: 8px;">
                Wusstest du es <strong>sofort</strong>?
            </div>
            <div class="btn-row">
                <button class="btn btn-yes" onclick="rateCard(true)">
                    <span>‚úì</span> Ja!
                </button>
                <button class="btn btn-no" onclick="rateCard(false)">
                    <span>‚Üª</span> Nochmal
                </button>
            </div>
        </div>
        
        <button class="btn btn-back" onclick="goHome()">‚Üê Zur√ºck</button>
    </div>

    <!-- Finish Screen -->
    <div id="finish-screen" class="screen">
        <div class="finish-icon">üéâ</div>
        <div class="finish-title">Super gemacht!</div>
        <div class="finish-subtitle">Kleine Portion erledigt</div>
        
        <div class="stats">
            <div class="stat-row">
                <span class="stat-label">Aufgaben</span>
                <span class="stat-value" id="stat-total">0</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">Sofort gewusst</span>
                <span class="stat-value" id="stat-known">0</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">Wiederholt</span>
                <span class="stat-value" id="stat-repeated">0</span>
            </div>
        </div>
        
        <button class="btn btn-restart" onclick="goHome()">
            Nochmal spielen
        </button>
    </div>

    <script>
        // Aufgaben-Datenbank
        const problems = {
            'plus10': [
                {q: "2 + 3", a: "5"}, {q: "4 + 2", a: "6"}, {q: "3 + 4", a: "7"},
                {q: "5 + 3", a: "8"}, {q: "2 + 6", a: "8"}, {q: "4 + 5", a: "9"},
                {q: "6 + 3", a: "9"}, {q: "7 + 2", a: "9"}, {q: "5 + 5", a: "10"},
                {q: "8 - 3", a: "5"}, {q: "9 - 4", a: "5"}, {q: "7 - 2", a: "5"},
                {q: "6 - 4", a: "2"}, {q: "10 - 3", a: "7"}, {q: "9 - 6", a: "3"}
            ],
            'mult': [
                {q: "2 √ó 3", a: "6"}, {q: "3 √ó 4", a: "12"}, {q: "4 √ó 5", a: "20"},
                {q: "5 √ó 6", a: "30"}, {q: "6 √ó 7", a: "42"}, {q: "7 √ó 8", a: "56"},
                {q: "8 √ó 9", a: "72"}, {q: "3 √ó 7", a: "21"}, {q: "4 √ó 8", a: "32"},
                {q: "6 √ó 6", a: "36"}, {q: "9 √ó 3", a: "27"}, {q: "5 √ó 7", a: "35"}
            ],
            'zehner': [
                {q: "8 + 5", a: "13", s: ["8 + 2", "10 + 3"]},
                {q: "7 + 6", a: "13", s: ["7 + 3", "10 + 3"]},
                {q: "9 + 4", a: "13", s: ["9 + 1", "10 + 3"]},
                {q: "6 + 7", a: "13", s: ["6 + 4", "10 + 3"]},
                {q: "8 + 7", a: "15", s: ["8 + 2", "10 + 5"]},
                {q: "5 + 9", a: "14", s: ["5 + 5", "10 + 4"]},
                {q: "7 + 7", a: "14", s: ["7 + 3", "10 + 4"]},
            ],
            'pyramid': {
                level1: [{q: "2 + 1", a: "3"}, {q: "3 + 1", a: "4"}, {q: "1 + 4", a: "5"}],
                level2: [{q: "3 + 2", a: "5"}, {q: "4 + 2", a: "6"}, {q: "2 + 5", a: "7"}],
                level3: [{q: "4 + 3", a: "7"}, {q: "5 + 3", a: "8"}, {q: "3 + 6", a: "9"}],
                level4: [{q: "5 + 4", a: "9"}, {q: "6 + 4", a: "10"}, {q: "4 + 5", a: "9"}],
                level5: [{q: "6 + 5", a: "11"}, {q: "7 + 5", a: "12"}, {q: "8 + 4", a: "12"}]
            }
        };

        let state = {
            mode: null,
            currentSet: [],
            currentIndex: 0,
            knownCount: 0,
            repeatCount: 0,
            originalLength: 0,
            pyramidLevel: 1,
            pyramidErrors: 0
        };

        const $card = document.getElementById('math-card');
        const $hint = document.getElementById('hint-text');
        const $preReveal = document.getElementById('pre-reveal');
        const $postReveal = document.getElementById('post-reveal');
        const $progressDots = document.getElementById('progress-dots');
        const $pyramidLevel = document.getElementById('pyramid-level');

        function shuffle(array) {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function startTraining(mode) {
            state.mode = mode;
            state.currentIndex = 0;
            state.knownCount = 0;
            state.repeatCount = 0;
            state.pyramidLevel = 1;
            state.pyramidErrors = 0;

            if (mode === 'pyramid') {
                loadPyramidLevel(1);
                $pyramidLevel.classList.remove('hidden');
            } else {
                state.currentSet = shuffle(problems[mode]).slice(0, 8);
                state.originalLength = state.currentSet.length;
                $pyramidLevel.classList.add('hidden');
            }

            showScreen('training-screen');
            showCard();
        }

        function loadPyramidLevel(level) {
            const levelKey = `level${level}`;
            if (!problems.pyramid[levelKey]) {
                finishTraining();
                return false;
            }
            state.currentSet = shuffle(problems.pyramid[levelKey]);
            state.originalLength = state.currentSet.length;
            state.currentIndex = 0;
            state.pyramidErrors = 0;
            $pyramidLevel.textContent = `üî∫ Level ${level} von 5`;
            return true;
        }

        function renderProgress() {
            const total = state.originalLength;
            let dots = '';
            for (let i = 0; i < total; i++) {
                if (i < state.currentIndex) {
                    dots += '<div class="dot done"></div>';
                } else if (i === state.currentIndex) {
                    dots += '<div class="dot current"></div>';
                } else {
                    dots += '<div class="dot"></div>';
                }
            }
            $progressDots.innerHTML = dots;
        }

        function showCard() {
            if (state.currentIndex >= state.currentSet.length) {
                if (state.mode === 'pyramid') {
                    // N√§chstes Level
                    state.pyramidLevel++;
                    if (!loadPyramidLevel(state.pyramidLevel)) return;
                    showCard();
                    return;
                }
                finishTraining();
                return;
            }

            const problem = state.currentSet[state.currentIndex];
            $card.textContent = problem.q;
            $card.classList.remove('revealed', 'celebrate');
            $card.style.fontSize = '4rem'; // Reset font size
            $card.style.animation = 'none';
            $card.offsetHeight; // Reflow
            $card.style.animation = 'cardPop 0.3s ease-out';

            $hint.textContent = 'Weisst du es sofort?';
            $hint.classList.remove('emphasis');
            
            $preReveal.classList.remove('hidden');
            $postReveal.classList.add('hidden');
            
            renderProgress();
        }

        function revealAnswer() {
            const problem = state.currentSet[state.currentIndex];

            if (state.mode === 'zehner' && problem.s) {
                // Step-by-step reveal for Zehner√ºbergang
                $card.style.fontSize = '3rem'; // Smaller font for steps
                $card.textContent = problem.s[0]; // e.g., "8 + 2"
                $hint.textContent = 'Erst den Zehner voll machen...';
                $hint.classList.add('emphasis');

                setTimeout(() => {
                    $card.textContent = problem.s[1]; // e.g., "10 + 3"
                    $hint.textContent = '...dann den Rest dazu.';
                }, 1200);

                setTimeout(() => {
                    $card.style.fontSize = '4rem'; // Back to big font
                    $card.textContent = problem.a;
                    $card.classList.add('revealed');
                    $hint.textContent = 'Einpr√§gen ‚Äì wie ein Foto!';
                }, 2400);

                setTimeout(() => {
                    $preReveal.classList.add('hidden');
                    $postReveal.classList.remove('hidden');
                }, 2400);

            } else {
                // Original reveal logic
                $card.textContent = problem.a;
                $card.classList.add('revealed');
                $hint.textContent = 'Einpr√§gen ‚Äì wie ein Foto!';
                $hint.classList.add('emphasis');
                $preReveal.classList.add('hidden');
                $postReveal.classList.remove('hidden');
            }
        }

        function rateCard(known) {
            if (known) {
                state.knownCount++;
                $card.classList.add('celebrate');
            } else {
                state.repeatCount++;
                state.pyramidErrors++;
                // Karte ans Ende des Stapels
                state.currentSet.push(state.currentSet[state.currentIndex]);
            }

            state.currentIndex++;
            
            setTimeout(() => {
                showCard();
            }, known ? 300 : 100);
        }

        function finishTraining() {
            document.getElementById('stat-total').textContent = state.originalLength;
            document.getElementById('stat-known').textContent = state.knownCount;
            document.getElementById('stat-repeated').textContent = state.repeatCount;
            showScreen('finish-screen');
        }

        function goHome() {
            showScreen('start-screen');
        }
    </script>
</body>
</html>