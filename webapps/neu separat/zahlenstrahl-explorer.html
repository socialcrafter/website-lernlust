<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zahlenstrahl-Explorer üîç</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&family=Fredoka+One&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6C63FF;
            --primary-light: #8B85FF;
            --secondary: #FF6B9D;
            --success: #4ECDC4;
            --warning: #FFE66D;
            --bg-gradient-1: #1a1a2e;
            --bg-gradient-2: #16213e;
            --card-bg: rgba(255, 255, 255, 0.08);
            --card-border: rgba(255, 255, 255, 0.12);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
            --line-color: rgba(255, 255, 255, 0.8);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, var(--bg-gradient-1) 0%, var(--bg-gradient-2) 100%);
            min-height: 100vh;
            color: var(--text-primary);
            overflow: hidden;
            user-select: none;
        }

        .container {
            height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 15px;
        }

        /* Header */
        header {
            text-align: center;
            padding: 10px 0 15px;
            flex-shrink: 0;
        }

        .logo {
            font-family: 'Fredoka One', cursive;
            font-size: 1.8rem;
            background: linear-gradient(135deg, var(--success), var(--primary-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 0.95rem;
            color: var(--text-secondary);
            font-weight: 600;
            margin-top: 5px;
        }

        /* Info Panel */
        .info-panel {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 15px;
            flex-shrink: 0;
        }

        .info-item {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 12px;
            padding: 10px 20px;
            text-align: center;
        }

        .info-label {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 3px;
        }

        .info-value {
            font-family: 'Fredoka One', cursive;
            font-size: 1.3rem;
            color: var(--warning);
        }

        .info-value.range {
            color: var(--success);
            font-size: 1.1rem;
        }

        /* Zoom Controls */
        .zoom-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
            flex-shrink: 0;
            flex-wrap: wrap;
        }

        .zoom-btn {
            padding: 12px 20px;
            font-family: 'Fredoka One', cursive;
            font-size: 1.1rem;
            background: var(--card-bg);
            border: 2px solid var(--card-border);
            border-radius: 12px;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .zoom-btn:hover {
            border-color: var(--primary-light);
            background: rgba(108, 99, 255, 0.2);
        }

        .zoom-btn:active {
            transform: scale(0.95);
        }

        .zoom-btn.primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            border-color: var(--primary);
        }

        .preset-btns {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .preset-btn {
            padding: 8px 16px;
            font-family: 'Nunito', sans-serif;
            font-size: 0.85rem;
            font-weight: 700;
            background: transparent;
            border: 2px solid var(--card-border);
            border-radius: 20px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .preset-btn:hover {
            border-color: var(--success);
            color: var(--success);
        }

        .preset-btn.active {
            background: var(--success);
            border-color: var(--success);
            color: var(--bg-gradient-1);
        }

        /* Main Numberline Area */
        .numberline-wrapper {
            flex: 1;
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 20px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            min-height: 250px;
        }

        .drag-hint {
            text-align: center;
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-bottom: 15px;
        }

        .drag-hint span {
            background: rgba(255, 255, 255, 0.1);
            padding: 4px 12px;
            border-radius: 10px;
        }

        /* Numberline Container - scrollable/draggable */
        .numberline-container {
            flex: 1;
            position: relative;
            overflow: hidden;
            cursor: grab;
            touch-action: none;
        }

        .numberline-container:active {
            cursor: grabbing;
        }

        .numberline {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            height: 120px;
            transition: left 0.1s ease-out;
        }

        /* Main line track */
        .line-track {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--line-color);
            border-radius: 2px;
            transform: translateY(-50%);
        }

        /* Tick marks - Zahlenbuch style */
        .tick {
            position: absolute;
            bottom: 50%;
            transform: translateX(-50%);
            background: var(--line-color);
        }

        /* Einer-Striche (1er) - kurz aber sichtbar */
        .tick.ones {
            width: 1.5px;
            height: 14px;
            background: rgba(255, 255, 255, 0.55);
        }

        /* F√ºnfer-Striche - mittel */
        .tick.fives {
            width: 2px;
            height: 24px;
            background: rgba(255, 255, 255, 0.75);
        }

        /* Zehner-Striche - lang */
        .tick.tens {
            width: 2.5px;
            height: 34px;
            background: rgba(255, 255, 255, 0.9);
        }

        /* F√ºnfziger-Striche - extra lang */
        .tick.fifties {
            width: 3px;
            height: 42px;
            background: var(--warning);
        }

        /* Hunderter-Striche - am l√§ngsten */
        .tick.hundreds {
            width: 4px;
            height: 52px;
            background: var(--success);
        }

        /* Labels */
        .tick-label {
            position: absolute;
            top: calc(50% + 8px);
            transform: translateX(-50%);
            font-family: 'Fredoka One', cursive;
            white-space: nowrap;
        }

        .tick-label.ones-label {
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.5);
        }

        .tick-label.fives-label {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .tick-label.tens-label {
            font-size: 0.9rem;
            color: var(--text-primary);
        }

        .tick-label.fifties-label {
            font-size: 1rem;
            color: var(--warning);
        }

        .tick-label.hundreds-label {
            font-size: 1.2rem;
            color: var(--success);
        }

        /* Position Marker */
        .position-marker {
            position: absolute;
            top: calc(50% - 55px);
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            pointer-events: none;
            transition: left 0.15s ease-out;
        }

        .marker-value {
            font-family: 'Fredoka One', cursive;
            font-size: 1.4rem;
            color: var(--secondary);
            background: rgba(255, 107, 157, 0.2);
            padding: 5px 15px;
            border-radius: 10px;
            border: 2px solid var(--secondary);
            margin-bottom: 5px;
        }

        .marker-arrow {
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 15px solid var(--secondary);
        }

        /* Legend */
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
            flex-shrink: 0;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .legend-line {
            height: 3px;
            border-radius: 2px;
        }

        .legend-line.hundreds { width: 25px; background: var(--success); height: 4px; }
        .legend-line.fifties { width: 20px; background: var(--warning); }
        .legend-line.tens { width: 15px; background: rgba(255, 255, 255, 0.85); }
        .legend-line.fives { width: 12px; background: rgba(255, 255, 255, 0.6); }
        .legend-line.ones { width: 8px; background: rgba(255, 255, 255, 0.4); }

        /* Scale indicator */
        .scale-indicator {
            position: absolute;
            bottom: 10px;
            right: 20px;
            background: rgba(0, 0, 0, 0.5);
            padding: 8px 15px;
            border-radius: 10px;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .scale-indicator span {
            color: var(--warning);
            font-weight: 700;
        }

        /* Touch/click feedback */
        .tap-feedback {
            position: absolute;
            width: 40px;
            height: 40px;
            border: 2px solid var(--primary-light);
            border-radius: 50%;
            transform: translate(-50%, -50%) scale(0);
            opacity: 0;
            pointer-events: none;
        }

        .tap-feedback.animate {
            animation: tapRipple 0.4s ease-out;
        }

        @keyframes tapRipple {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(2); opacity: 0; }
        }

        /* Responsive */
        @media (max-width: 600px) {
            .info-panel {
                gap: 10px;
            }
            
            .info-item {
                padding: 8px 15px;
            }

            .zoom-btn {
                padding: 10px 15px;
                font-size: 1rem;
            }

            .preset-btn {
                padding: 6px 12px;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1 class="logo">üîç Zahlenstrahl-Explorer</h1>
            <p class="subtitle">Entdecke die Welt der Zahlen!</p>
        </header>

        <!-- Info Panel -->
        <div class="info-panel">
            <div class="info-item">
                <div class="info-label">Mitte</div>
                <div class="info-value" id="centerValue">500</div>
            </div>
            <div class="info-item">
                <div class="info-label">Sichtbar</div>
                <div class="info-value range" id="rangeValue">0 ‚Äì 1000</div>
            </div>
            <div class="info-item">
                <div class="info-label">Zoom</div>
                <div class="info-value" id="zoomLevel">1√ó</div>
            </div>
        </div>

        <!-- Zoom Controls -->
        <div class="zoom-controls">
            <button class="zoom-btn" onclick="zoomOut()">‚ûñ Raus</button>
            <button class="zoom-btn primary" onclick="resetZoom()">üè† Reset</button>
            <button class="zoom-btn" onclick="zoomIn()">‚ûï Rein</button>
        </div>

        <div class="preset-btns">
            <button class="preset-btn" onclick="setPreset(0, 100, '0-100')">0‚Äì100</button>
            <button class="preset-btn" onclick="setPreset(0, 20, '0-20')">0‚Äì20</button>
            <button class="preset-btn" onclick="setPreset(50, 10, '45-55')">um 50</button>
            <button class="preset-btn active" onclick="setPreset(500, 1000, '0-1000')">0‚Äì1000</button>
            <button class="preset-btn" onclick="setPreset(500, 200, '400-600')">400‚Äì600</button>
            <button class="preset-btn" onclick="setPreset(550, 50, '525-575')">um 550</button>
        </div>

        <!-- Numberline -->
        <div class="numberline-wrapper">
            <div class="drag-hint">
                <span>üëÜ Ziehen zum Bewegen ‚Ä¢ Tippen f√ºr Position</span>
            </div>
            
            <div class="numberline-container" id="numberlineContainer">
                <div class="numberline" id="numberline">
                    <div class="line-track"></div>
                    <!-- Ticks generated by JS -->
                </div>
                
                <div class="position-marker" id="positionMarker">
                    <div class="marker-value" id="markerValue">500</div>
                    <div class="marker-arrow"></div>
                </div>

                <div class="tap-feedback" id="tapFeedback"></div>

                <div class="scale-indicator">
                    1 K√§stchen = <span id="scaleValue">10</span>
                </div>
            </div>

            <div class="legend">
                <div class="legend-item">
                    <div class="legend-line hundreds"></div>
                    <span>100er</span>
                </div>
                <div class="legend-item">
                    <div class="legend-line fifties"></div>
                    <span>50er</span>
                </div>
                <div class="legend-item">
                    <div class="legend-line tens"></div>
                    <span>10er</span>
                </div>
                <div class="legend-item">
                    <div class="legend-line fives"></div>
                    <span>5er</span>
                </div>
                <div class="legend-item">
                    <div class="legend-line ones"></div>
                    <span>1er</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        /* ============================================
           STATE
        ============================================ */
        let state = {
            center: 500,           // Mittelpunkt der Ansicht
            visibleRange: 1000,    // Sichtbarer Bereich (z.B. 1000 = von 0-1000)
            minRange: 10,          // Minimaler Zoom (10 Zahlen sichtbar)
            maxRange: 2000,        // Maximaler Zoom (2000 Zahlen sichtbar)
            pixelsPerUnit: 1,      // Wird berechnet
            isDragging: false,
            startX: 0,
            startCenter: 0,
            markerPosition: 500
        };

        const container = document.getElementById('numberlineContainer');
        const numberline = document.getElementById('numberline');
        const positionMarker = document.getElementById('positionMarker');

        /* ============================================
           INITIALIZATION
        ============================================ */
        function init() {
            calculateDimensions();
            renderNumberline();
            updateDisplay();
            setupEventListeners();
            
            window.addEventListener('resize', () => {
                calculateDimensions();
                renderNumberline();
            });
        }

        function calculateDimensions() {
            const containerWidth = container.clientWidth;
            state.pixelsPerUnit = containerWidth / state.visibleRange;
        }

        /* ============================================
           RENDER NUMBERLINE
           Zahlenbuch-Stil: 5er und 10er l√§ngere Striche
        ============================================ */
        function renderNumberline() {
            // Clear existing ticks
            const existingTicks = numberline.querySelectorAll('.tick, .tick-label');
            existingTicks.forEach(el => el.remove());

            const containerWidth = container.clientWidth;
            const totalWidth = state.pixelsPerUnit * state.maxRange * 2;
            numberline.style.width = `${totalWidth}px`;

            // Determine which tick levels to show based on zoom
            const showOnes = state.visibleRange <= 50;
            const showFives = state.visibleRange <= 200;
            const showTens = state.visibleRange <= 500;
            const showFifties = state.visibleRange <= 1500;
            // Hundreds always shown

            // Calculate visible range with buffer
            const minVisible = Math.max(0, state.center - state.visibleRange);
            const maxVisible = state.center + state.visibleRange;

            // Render ticks
            for (let num = 0; num <= 2000; num++) {
                // Skip if not in extended visible range
                if (num < minVisible - 100 || num > maxVisible + 100) continue;

                const position = num * state.pixelsPerUnit;
                let tickClass = '';
                let labelClass = '';
                let showLabel = false;

                if (num % 100 === 0) {
                    tickClass = 'hundreds';
                    labelClass = 'hundreds-label';
                    showLabel = true;
                } else if (num % 50 === 0 && showFifties) {
                    tickClass = 'fifties';
                    labelClass = 'fifties-label';
                    showLabel = state.visibleRange <= 500;
                } else if (num % 10 === 0 && showTens) {
                    tickClass = 'tens';
                    labelClass = 'tens-label';
                    showLabel = state.visibleRange <= 200;
                } else if (num % 5 === 0 && showFives) {
                    tickClass = 'fives';
                    labelClass = 'fives-label';
                    showLabel = state.visibleRange <= 50;
                } else if (showOnes) {
                    tickClass = 'ones';
                    labelClass = 'ones-label';
                    showLabel = state.visibleRange <= 20;
                }

                if (tickClass) {
                    // Create tick
                    const tick = document.createElement('div');
                    tick.className = `tick ${tickClass}`;
                    tick.style.left = `${position}px`;
                    numberline.appendChild(tick);

                    // Create label if needed
                    if (showLabel) {
                        const label = document.createElement('div');
                        label.className = `tick-label ${labelClass}`;
                        label.style.left = `${position}px`;
                        label.textContent = num;
                        numberline.appendChild(label);
                    }
                }
            }

            updatePosition();
        }

        /* ============================================
           UPDATE POSITION
        ============================================ */
        function updatePosition() {
            const containerWidth = container.clientWidth;
            const centerOffset = state.center * state.pixelsPerUnit;
            const lineOffset = containerWidth / 2 - centerOffset;
            
            numberline.style.left = `${lineOffset}px`;

            // Update marker position
            const markerOffset = state.markerPosition * state.pixelsPerUnit + lineOffset;
            positionMarker.style.left = `${markerOffset}px`;
        }

        /* ============================================
           ZOOM FUNCTIONS
        ============================================ */
        function zoomIn() {
            const newRange = state.visibleRange / 2;
            if (newRange >= state.minRange) {
                state.visibleRange = newRange;
                calculateDimensions();
                renderNumberline();
                updateDisplay();
            }
        }

        function zoomOut() {
            const newRange = state.visibleRange * 2;
            if (newRange <= state.maxRange) {
                state.visibleRange = newRange;
                calculateDimensions();
                renderNumberline();
                updateDisplay();
            }
        }

        function resetZoom() {
            state.center = 500;
            state.visibleRange = 1000;
            state.markerPosition = 500;
            calculateDimensions();
            renderNumberline();
            updateDisplay();
            updatePresetButtons('0-1000');
        }

        function setPreset(center, range, id) {
            state.center = center;
            state.visibleRange = range;
            state.markerPosition = center;
            calculateDimensions();
            renderNumberline();
            updateDisplay();
            updatePresetButtons(id);
        }

        function updatePresetButtons(activeId) {
            document.querySelectorAll('.preset-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent.includes(activeId.split('-')[0])) {
                    // Simple matching - could be improved
                }
            });
            // Find and activate the right button
            document.querySelectorAll('.preset-btn').forEach(btn => {
                const btnRange = btn.getAttribute('onclick');
                if (btnRange && btnRange.includes(`'${activeId}'`)) {
                    btn.classList.add('active');
                }
            });
        }

        /* ============================================
           UPDATE DISPLAY
        ============================================ */
        function updateDisplay() {
            document.getElementById('centerValue').textContent = Math.round(state.center);
            
            const minVisible = Math.max(0, Math.round(state.center - state.visibleRange / 2));
            const maxVisible = Math.round(state.center + state.visibleRange / 2);
            document.getElementById('rangeValue').textContent = `${minVisible} ‚Äì ${maxVisible}`;

            // Calculate zoom level relative to base (1000 range = 1x)
            const zoomLevel = 1000 / state.visibleRange;
            document.getElementById('zoomLevel').textContent = 
                zoomLevel >= 1 ? `${zoomLevel.toFixed(0)}√ó` : `1/${(1/zoomLevel).toFixed(0)}`;

            // Scale indicator
            let scaleValue;
            if (state.visibleRange <= 20) scaleValue = 1;
            else if (state.visibleRange <= 50) scaleValue = 5;
            else if (state.visibleRange <= 200) scaleValue = 10;
            else if (state.visibleRange <= 500) scaleValue = 50;
            else scaleValue = 100;
            document.getElementById('scaleValue').textContent = scaleValue;

            document.getElementById('markerValue').textContent = Math.round(state.markerPosition);
        }

        /* ============================================
           EVENT LISTENERS
        ============================================ */
        function setupEventListeners() {
            // Mouse events
            container.addEventListener('mousedown', startDrag);
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', endDrag);

            // Touch events
            container.addEventListener('touchstart', startDrag, { passive: false });
            document.addEventListener('touchmove', drag, { passive: false });
            document.addEventListener('touchend', endDrag);

            // Click to set marker
            container.addEventListener('click', handleClick);

            // Wheel zoom
            container.addEventListener('wheel', handleWheel, { passive: false });
        }

        function startDrag(e) {
            state.isDragging = true;
            state.startX = e.touches ? e.touches[0].clientX : e.clientX;
            state.startCenter = state.center;
            container.style.cursor = 'grabbing';
        }

        function drag(e) {
            if (!state.isDragging) return;
            e.preventDefault();

            const clientX = e.touches ? e.touches[0].clientX : e.clientX;
            const deltaX = state.startX - clientX;
            const deltaUnits = deltaX / state.pixelsPerUnit;

            state.center = Math.max(0, Math.min(2000, state.startCenter + deltaUnits));
            updatePosition();
            updateDisplay();
        }

        function endDrag() {
            if (state.isDragging) {
                state.isDragging = false;
                container.style.cursor = 'grab';
            }
        }

        function handleClick(e) {
            if (state.isDragging) return;

            const rect = container.getBoundingClientRect();
            const clickX = e.clientX - rect.left;
            
            // Calculate number at click position
            const lineOffset = parseFloat(numberline.style.left) || 0;
            const numberAtClick = (clickX - lineOffset) / state.pixelsPerUnit;

            // Set marker position (clamped to 0-2000)
            state.markerPosition = Math.max(0, Math.min(2000, Math.round(numberAtClick)));
            updatePosition();
            updateDisplay();

            // Visual feedback
            showTapFeedback(e.clientX - rect.left, e.clientY - rect.top);
        }

        function handleWheel(e) {
            e.preventDefault();
            
            if (e.deltaY < 0) {
                zoomIn();
            } else {
                zoomOut();
            }
        }

        function showTapFeedback(x, y) {
            const feedback = document.getElementById('tapFeedback');
            feedback.style.left = `${x}px`;
            feedback.style.top = `${y}px`;
            feedback.classList.remove('animate');
            void feedback.offsetWidth; // Trigger reflow
            feedback.classList.add('animate');
        }

        // Initialize
        init();
    </script>
</body>
</html>
